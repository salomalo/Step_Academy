<?xml version="1.0" encoding="windows-1251" ?>

<!DOCTYPE page [
<!ENTITY nbsp "&#160;">
<!ENTITY пробел "&#160;">
<!ENTITY shy "&#173;">
<!ENTITY перенос "&#173;">
]>

<?xml:stylesheet type="text/xsl" href="../common/layout.xsl" ?>

<Урок xmlns="x-schema:Schema.xml" название="Оператор SELECT INTO."  предыдущий="section07.xml" следующий="section09.xml" copyright="© 2005 Вадим Волянский, Алексей Туманов.">

<h2><font color="#800000">Оператор SELECT INTO.</font></h2>

<p>
С помощью этого оператора можно создать таблицу, значения в которой будут является значениями результата запроса на выборку. Созданная таким образом таблица может быть либо временной (которая автоматически уничтожится после завершение сеанса связи с сервером), либо постоянной. И в том и в другом случае для столбцов желательно указывать псевдонимы (при помощи ключевого слова as), чтобы в дальнейшем не было проблем с идентификацией полей созданной таблицы.
</p>

<p>
Общий синтаксис:
</p>

<pre  style="border:3px #FF0000 solid">
Select имя_поля1 as псевдоним1, имя_поля2 as псевдоним2, имя_поля3 as псевдоним3<br/>
Into имя_новой_таблицы<br/>
From имя_таблицы<br/>
Where условие
</pre>

<p>
Т.о. создается таблица с именем Имя_новой_таблицы, имена полей в которой называются Псевдоним1, Псевдоним2, Псевдоним3, значения в которой - это значения из таблицы Имя_таблицы, для которых указанное условие является верным.
</p>

<p>
Пример.
</p>
<pre>
Select name as book,izd as Press<br/>
Into Table1<br/>
From books<br/>
Where new=1
</pre>

<p>
Если вы выполните этот запрос, то у вас создастся новая таблица Table1, состоящая из двух полей book - название книги и press - издательство. При этом хранятся там только книги новинки (new=1) из таблицы Books.
</p>

<p>
Теперь у вас есть возможность писать запросы к таблице Table1. Изменение значений в таблице Table1 никак не повлияет на таблицу books.
</p>

<p>
Как уже указывалось, вы можете также создавать временные таблицы. Временные таблицы автоматически сохраняются в базу данных tempdb.
</p>

<p>
Все что вам нужно сделать для создания временной таблицы, это перед именем создаваемой таблицы оператора Select Into указать #. При этом будет создана ЛОКАЛЬНАЯ временная таблица, которая уничтожится после завершения текущего сеанса работы с SQL Server. Также перед именем можно указать ##. Тогда создастся ГЛОБАЛЬНАЯ временная таблица, которая будет доступна всем подключенным к серверу пользователям и уничтожена она будет после отключения от сервера последнего пользователя.
</p>

<pre>
Select Name,Themes,Pages,Date,Price<br/>
Into ##temp_table1<br/>
From books<br/>
where price>250<br/>
Order by Name
</pre>

<p>
Учитывая, что псевдонимы для столбцов не указаны, будут взяты имена из таблицы books.  
</p>

</Урок>