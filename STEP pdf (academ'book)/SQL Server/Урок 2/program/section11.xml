<?xml version="1.0" encoding="windows-1251" ?>

<!DOCTYPE page [
<!ENTITY nbsp "&#160;">
<!ENTITY пробел "&#160;">
<!ENTITY shy "&#173;">
<!ENTITY перенос "&#173;">
]>

<?xml:stylesheet type="text/xsl" href="../common/layout.xsl" ?>

<Урок xmlns="x-schema:Schema.xml" название="Импорт данных" 
предыдущий="section03.xml" следующий="section04.xml" copyright="© 2005 Вадим Волянский, Алексей Туманов.">
<h2 style="color=maroon">Импорт данных.</h2>

<p>
Для того, чтобы у вас, господа студенты, была учебная база данных для выполнения запросов, вы должны эту базу данных импортировать.
Для начала файл базы вы должны скопировать на свой жесткий диск. Требуемая база данных вот <a href="Database/books.mdb">Library</a>, которую вы можете найти в папке <a href="Database">Database</a>. Это база данных ACCESS, с которой мы и будем импортировать данные.
</p>

<p>
Открываем Enterprise Manager и выбираем в главном меню Tools -> Data Transformation Services -> Import Data. Но при этом должен быть выбран сервер, в который нужно импортировать базу данных.
</p>

<img src="img/pict10.jpg"></img>

<p>
Появится следующее окошко:
</p>

<img src="img/pict11.jpg"></img>

<p>
В нем, конечно же, нажимаем Далее.
</p>

<img src="img/pict12.jpg"></img>

<p>
Поле Data Source отвечает за тип файла, с которого будет производиться импортирование данных. Учитывая, что наш файл это файл ACCESS, выбираем в выпадающем списке Microsoft Access.
</p>

<p>
В строке File name нужно указать путь к файлу на жестком диске.
</p>

<p>
Username указываем, если для открытия базы данных Access нужно ввести логин, а Password - пароль для открытия. (Для учебной базы данных это указывать не нужно).
</p>

<p>
Нажимаем Далее.
</p>

<img src="img/pict13.jpg"></img>

<p>
Destination - поле, определяющее, куда будет импортироваться база данных. Это наш SQL Server, поэтому оставляем этот пункт без изменений.
</p>

<p>
В выпадающем списке Source можно выбрать, в какой из существующих серверов нужно поместить импортированную базу.
</p>

<p>
Ниже указывается способ подключения к выбранному серверу.
</p>

<p>
В выпадающем списке Database нужно выбрать &lt;new&gt;. Этим вы определяете, что вы хотите создать новую базу данных для импортированной информации. Как только вы выберете &lt;new&gt;, появится окошко с настройками для создаваемой базы данных.
</p>

<img src="img/pict14.jpg"></img>

<p>
Строка Name - это название создаваемой базы данных (указываем books). Data file size - размер создаваемого файла базы данных. Log file size - размер файла транзакций.
</p>

<p>
Далее.
</p>

<img src="img/pict15.jpg"></img>

<p>
В следующем окне вы определяете что должно быть скопировано.
</p>

<ul>
<li>Copy table(s) and view(s) from the source database - скопировать таблицы и представления из базы данных, указанной в ресурсах.</li>
<li>Use a query to specify the data to transfer - выбрав этот пункт, вы сможете написать запрос, определяющий процесс копирования.</li>
</ul>

<p>
Далее.
</p>

<img src="img/pict16.jpg"></img>

<p>
Вам предлагается список импортируемых таблиц и представлений (в нашем случае таблица одна). Таблицы, которые вам не нужны - отключаете.
</p>

<p>
Далее.
</p>

<img src="img/pict17.jpg"></img>

<p>
Run immediately - произвести импортирование немедленно.
</p>

<p>
Далее.
</p>

<img src="img/pict18.jpg"></img>

<p>
Готово.
</p>

<p>
Вызовете контекстное меню к папке Databases и выберете Обновить. Посмотрите - ваша новая база на месте.
</p>

<img src="img/pict19.jpg"></img>

</Урок>